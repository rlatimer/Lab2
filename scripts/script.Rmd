---
title: "Lab 2"
author: "Hyeonjin Cha"
date: "1/30/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# install.packages("fivethirtyeight")
# remotes::install_github("fivethirtyeightdata/fivethirtyeightdata")
library(fivethirtyeight)
library(fivethirtyeightdata)
library(tidyverse)
```

## 1. Google Trends Data
```{r googletrends}
#dataset
google_trends_longer <- google_trends %>%
  pivot_longer(cols = starts_with("hurricane"),
               names_to = "hurricane",
               names_prefix = "hurricane_",
               values_to = "mentions")

#part 1
plot1 <- google_trends_longer %>%
  ggplot(aes(date, mentions, color = hurricane)) +
  geom_line() +
  facet_wrap(~hurricane) +
  theme_minimal()
plot1

#part2
plot2 <- google_trends_longer %>%
  ggplot(aes(date, mentions, fill = hurricane)) +
  geom_area(position = "dodge", alpha = 0.8) +
  theme_minimal()
plot2

#part3
plot3 <- google_trends_longer %>%
  ggplot(aes(date, mentions, color = hurricane)) +
  geom_area() +
  scale_fill_continuous(low = "white", high = "red") +
  theme_minimal()

#part 4

# google_trends_longer_landfall <- google_trends_longer %>%
#   mutate(landfall = 0) %>%
#   mutate(landfall = ifelse(
#     hurricane == "harvey_us" & date == "2017-08-25" |
#     hurricane == "irma_us" & date == "2017-09-10" |
#     hurricane == "maria_us" & date == "2017-09-20",
#     1, 0))
#probably not the way Daniel intended....

landfall <- data.frame(hurricane = c("harvey_us", "irma_us", "maria_us"),
                       date = as.Date(c("2017-08-25", "2017-09-10", "2017-09-20")),
                       Ref = c("Harvey landfall", "Irma landfall", "Maria landfall"),
                       stringsAsFactors = FALSE)

plot4 <- google_trends_longer %>%
  ggplot(aes(date, mentions, fill = hurricane)) +
  geom_area(position = "dodge", alpha = 0.8) +
  geom_vline(data = landfall, aes(xintercept=as.numeric(date[c(1,2,3)]))) +
  theme_minimal()
plot4

#part 5
plot5 <- google_trends_longer %>%
  ggplot(aes(date, mentions, fill = hurricane)) +
  geom_area(position = "dodge", alpha = 0.8) +
  geom_vline(data = landfall, aes(xintercept=as.numeric(date[c(1,2,3)])), linetype=4) +
  geom_text(mapping = aes(x = date,
                          y = 100,
                          label = Ref,
                          hjust = 0,
                          vjust = 0),
            data = landfall) +
  labs(title = "US Google Search Interest on Hurricanes",
       x = "Date",
       y = "Search Interest",
       label = "Hurricane",
       caption = "Search interest measured in search term popularity relative to peak popularity
       in the given region and time period (with 100 as peak popularity)") +
  scale_fill_discrete(name  ="Hurricane",
                      breaks=c("harvey_us", "irma_us", "jose_us", "maria_us"),
                      labels=c("Harvey", "Irma", "Jose", "Maria")) +
  theme_minimal()
plot5

```


## 2. Replicating “National cable news networks” Plot
```{r tv_states}
tv_states_longer <- tv_states %>%
  pivot_longer(cols = florida:puerto_rico,
               names_to = "state",
               values_to = "percent")

TVlines<- data.frame(state = c("florida", "texas", "puerto_rico","florida"),
                     date = as.Date(c("2017-08-25", "2017-09-10", "2017-09-20", "2017-10-01")),
                     RefTV = c("Harvey landfall", "Irma landfall", "Maria landfall", "Las Vegas shooting"),
                     stringsAsFactors = FALSE)

TVplot <- tv_states_longer %>%
  ggplot(aes(date, percent, fill = state)) +
  guides(fill = FALSE) +
  geom_area(position = "dodge") +
  geom_vline(data = TVlines, aes(xintercept=as.numeric(date[c(1,2,3,4)])), linetype=4) +
  geom_text(mapping = aes(x = date,
                          y = 4,
                          label = RefTV,
                          hjust = "center",
                          vjust = 0),
            data = TVlines) +
            scale_fill_manual(values = c("#ff007b","#00d9ff","#ff6e00"))+
  labs(title = "National cable news networks",
       x = NULL,
       y = "Share of sentences",
       caption = "Includes Bloomberg, CNBC, CNN, Fox Business, Fox News and MSNBC.") +
  
  theme_minimal()

TVplot


```

## 2. Using Comic_characters Dataset
```{r comic_characters}
```


